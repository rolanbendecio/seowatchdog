{
  "name": "SEO Watchdog - Keyword Priority Tracking",
  "description": "Advanced SEO monitoring with keyword prioritization and Google Sheets integration",
  "version": "2.2",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "value": "0 9 * * *"
            }
          ]
        }
      },
      "id": "scheduler",
      "name": "Daily Schedule",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 1,
      "position": [240, 300],
      "notes": "üïò DAILY SCHEDULER: Triggers keyword priority analysis at 9 AM"
    },
    {
      "parameters": {
        "jsCode": "// üéØ KEYWORD PRIORITY CONFIGURATION\n// Configures batch processing and keyword prioritization\n\nconst priorityConfig = {\n  // üìä BATCH SIZES (optimized for performance)\n  performance_batch_size: 100,\n  keywords_batch_size: 50,\n  indexing_batch_size: 100,\n  tracked_keywords_limit: 200,\n  \n  // ‚ö° PERFORMANCE SETTINGS\n  batch_delay: 2000,\n  query_timeout: 45000,\n  max_days_back: 30,\n  \n  // üéØ KEYWORD PRIORITY THRESHOLDS\n  priority_scoring: {\n    high_impressions_threshold: 10000,    // High volume keywords\n    medium_impressions_threshold: 1000,   // Medium volume keywords\n    low_ctr_threshold: 2.0,               // CTR below 2%\n    good_ctr_threshold: 5.0,              // CTR above 5%\n    high_position_threshold: 3,           // Top 3 positions\n    medium_position_threshold: 10,        // Top 10 positions\n    low_position_threshold: 20,           // Top 20 positions\n    min_clicks_threshold: 5               // Minimum clicks for relevance\n  },\n  \n  // üî¢ PRIORITY SCORING WEIGHTS\n  scoring_weights: {\n    impressions_weight: 0.3,              // 30% - Search volume importance\n    position_weight: 0.25,                // 25% - Current ranking importance\n    ctr_weight: 0.2,                      // 20% - Click-through rate importance\n    clicks_weight: 0.15,                  // 15% - Actual traffic importance\n    trend_weight: 0.1                     // 10% - Performance trend importance\n  }\n};\n\n// üìÖ DATE RANGE CALCULATION\nconst dateRange = {\n  start_date: new Date(Date.now() - (priorityConfig.max_days_back * 24 * 60 * 60 * 1000)).toISOString().split('T')[0],\n  end_date: new Date(Date.now() - (24 * 60 * 60 * 1000)).toISOString().split('T')[0],\n  analysis_date: new Date().toISOString().split('T')[0]\n};\n\n// üéØ EXECUTION METADATA\nconst executionMetadata = {\n  priority_config: priorityConfig,\n  date_range: dateRange,\n  execution_id: `seo_priority_${Date.now()}`,\n  start_time: new Date().toISOString(),\n  workflow_version: '2.2-priority'\n};\n\nconsole.log('üéØ Keyword Priority Configuration Loaded');\nconsole.log(`üìÖ Date Range: ${dateRange.start_date} to ${dateRange.end_date}`);\nconsole.log(`üî¢ Batch Size: ${priorityConfig.keywords_batch_size} keywords`);\n\nreturn { json: executionMetadata };"
      },
      "id": "priority_config",
      "name": "Priority Configuration",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [460, 300],
      "notes": "üéØ KEYWORD PRIORITY CONFIGURATION\n\nüìã PRIORITY SYSTEM:\n‚Ä¢ High/Medium/Low thresholds\n‚Ä¢ Scoring weights configuration\n‚Ä¢ Performance benchmarks\n‚Ä¢ Batch processing limits\n\nüî¢ SCORING FACTORS:\n‚Ä¢ Impressions (30%): Search volume\n‚Ä¢ Position (25%): Current ranking\n‚Ä¢ CTR (20%): Click-through rate\n‚Ä¢ Clicks (15%): Actual traffic\n‚Ä¢ Trend (10%): Performance change\n\n‚ö° PERFORMANCE:\n‚Ä¢ Optimized batch sizes\n‚Ä¢ Timeout prevention\n‚Ä¢ Efficient processing"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "documentId": "={{ $env.TRACKED_KEYWORDS_SHEET_ID }}",
        "sheetName": "Keywords",
        "range": "A:E",
        "options": {
          "headerRow": true
        }
      },
      "id": "get_tracked_keywords",
      "name": "Get Tracked Keywords",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [680, 200],
      "notes": "üìä TRACKED KEYWORDS FROM GOOGLE SHEETS\n\nüìã SHEET STRUCTURE (A:E):\n‚Ä¢ Column A: Keyword\n‚Ä¢ Column B: Priority (High/Medium/Low)\n‚Ä¢ Column C: Target Position\n‚Ä¢ Column D: Business Value (1-10)\n‚Ä¢ Column E: Notes\n\nüéØ PURPOSE:\n‚Ä¢ Load user-defined keywords\n‚Ä¢ Apply manual priorities\n‚Ä¢ Set target positions\n‚Ä¢ Track business value\n\nüîß CONFIGURATION:\n‚Ä¢ Sheet ID: TRACKED_KEYWORDS_SHEET_ID env var\n‚Ä¢ Sheet Name: 'Keywords'\n‚Ä¢ Range: A:E (all keyword data)\n‚Ä¢ Header Row: Enabled\n\nüìà FEATURES:\n‚Ä¢ Manual keyword entry\n‚Ä¢ Priority override capability\n‚Ä¢ Business value weighting\n‚Ä¢ Custom notes tracking"
    },
    {
      "parameters": {
        "jsCode": "// üéØ KEYWORD LIST PROCESSOR\n// Processes and validates tracked keywords from Google Sheets\n\ntry {\n  // üìä Extract keywords data\n  const keywordsData = $input.all() || [];\n  \n  // üõ°Ô∏è Validate and clean keyword data\n  const validKeywords = keywordsData\n    .filter(item => item.json && item.json.Keyword && item.json.Keyword.trim())\n    .map(item => ({\n      keyword: item.json.Keyword.trim().toLowerCase(),\n      priority: item.json.Priority || 'Medium',\n      target_position: parseInt(item.json['Target Position']) || 10,\n      business_value: parseInt(item.json['Business Value']) || 5,\n      notes: item.json.Notes || '',\n      manual_priority: true\n    }));\n  \n  // üéØ Create keyword filter for BigQuery\n  const keywordsList = validKeywords.map(k => `'${k.keyword.replace(/'/g, \"''\")}'`).join(', ');\n  \n  // üìä Priority distribution\n  const priorityCount = {\n    high: validKeywords.filter(k => k.priority.toLowerCase() === 'high').length,\n    medium: validKeywords.filter(k => k.priority.toLowerCase() === 'medium').length,\n    low: validKeywords.filter(k => k.priority.toLowerCase() === 'low').length\n  };\n  \n  // üéØ Processed keyword data\n  const processedKeywords = {\n    tracked_keywords: validKeywords,\n    keywords_list: keywordsList,\n    total_keywords: validKeywords.length,\n    priority_distribution: priorityCount,\n    keywords_query_filter: validKeywords.length > 0 ? \n      `AND LOWER(query) IN (${keywordsList})` : '',\n    processing_status: {\n      success: true,\n      keywords_loaded: validKeywords.length,\n      has_tracked_keywords: validKeywords.length > 0\n    }\n  };\n  \n  console.log(`‚úÖ Tracked Keywords Loaded: ${validKeywords.length}`);\n  console.log(`üéØ Priority Distribution - High: ${priorityCount.high}, Medium: ${priorityCount.medium}, Low: ${priorityCount.low}`);\n  \n  return { json: processedKeywords };\n  \n} catch (error) {\n  console.error('‚ùå Keyword Processing Error:', error.message);\n  \n  return {\n    json: {\n      tracked_keywords: [],\n      keywords_list: '',\n      total_keywords: 0,\n      priority_distribution: { high: 0, medium: 0, low: 0 },\n      keywords_query_filter: '',\n      processing_status: {\n        success: false,\n        keywords_loaded: 0,\n        has_tracked_keywords: false,\n        error: error.message\n      }\n    }\n  };\n}"
      },
      "id": "process_keywords",
      "name": "Process Keywords",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 200],
      "notes": "üéØ KEYWORD PROCESSOR\n\nüìä PROCESSING FEATURES:\n‚Ä¢ Validates keyword data\n‚Ä¢ Cleans and formats keywords\n‚Ä¢ Creates BigQuery filter\n‚Ä¢ Counts priority distribution\n\nüõ°Ô∏è DATA VALIDATION:\n‚Ä¢ Removes empty keywords\n‚Ä¢ Trims whitespace\n‚Ä¢ Converts to lowercase\n‚Ä¢ Escapes SQL quotes\n\nüìà OUTPUT:\n‚Ä¢ Processed keyword list\n‚Ä¢ Priority distribution\n‚Ä¢ SQL filter string\n‚Ä¢ Processing status\n\nüîß ERROR HANDLING:\n‚Ä¢ Try-catch protection\n‚Ä¢ Graceful failure\n‚Ä¢ Error message logging\n‚Ä¢ Fallback to empty dataset"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "projectId": "={{ $env.GCP_PROJECT_ID }}",
        "query": "-- üéØ KEYWORD PRIORITY PERFORMANCE QUERY\n-- Analyzes tracked keywords with priority scoring\n\nWITH tracked_keyword_data AS (\n  SELECT \n    date,\n    query,\n    page,\n    device,\n    SUM(clicks) as clicks,\n    SUM(impressions) as impressions,\n    SAFE_DIVIDE(SUM(clicks), SUM(impressions)) * 100 as ctr,\n    AVG(position) as position,\n    -- üéØ Calculate weekly data for trends\n    DATE_TRUNC(date, WEEK) as week\n  FROM `{{ $env.GCP_PROJECT_ID }}.searchconsole.searchdata_site_impression`\n  WHERE \n    date >= '{{ $(\"Process Keywords\").first().json.date_range.start_date || $json.date_range.start_date }}'\n    AND date <= '{{ $(\"Process Keywords\").first().json.date_range.end_date || $json.date_range.end_date }}'\n    {{ $(\"Process Keywords\").first().json.keywords_query_filter || '' }}\n    AND impressions >= 5  -- Minimum impressions for relevance\n  GROUP BY date, query, page, device, week\n),\n\nkeyword_performance AS (\n  SELECT \n    query,\n    page,\n    SUM(clicks) as total_clicks,\n    SUM(impressions) as total_impressions,\n    SAFE_DIVIDE(SUM(clicks), SUM(impressions)) * 100 as avg_ctr,\n    AVG(position) as avg_position,\n    COUNT(DISTINCT date) as days_with_data,\n    \n    -- üìä PRIORITY SCORING COMPONENTS\n    CASE \n      WHEN SUM(impressions) >= {{ $json.priority_config.priority_scoring.high_impressions_threshold }} THEN 'HIGH_VOLUME'\n      WHEN SUM(impressions) >= {{ $json.priority_config.priority_scoring.medium_impressions_threshold }} THEN 'MEDIUM_VOLUME'\n      ELSE 'LOW_VOLUME'\n    END as volume_tier,\n    \n    CASE \n      WHEN AVG(position) <= {{ $json.priority_config.priority_scoring.high_position_threshold }} THEN 'TOP_3'\n      WHEN AVG(position) <= {{ $json.priority_config.priority_scoring.medium_position_threshold }} THEN 'TOP_10'\n      WHEN AVG(position) <= {{ $json.priority_config.priority_scoring.low_position_threshold }} THEN 'TOP_20'\n      ELSE 'BELOW_20'\n    END as position_tier,\n    \n    CASE \n      WHEN SAFE_DIVIDE(SUM(clicks), SUM(impressions)) * 100 >= {{ $json.priority_config.priority_scoring.good_ctr_threshold }} THEN 'GOOD_CTR'\n      WHEN SAFE_DIVIDE(SUM(clicks), SUM(impressions)) * 100 <= {{ $json.priority_config.priority_scoring.low_ctr_threshold }} THEN 'LOW_CTR'\n      ELSE 'AVERAGE_CTR'\n    END as ctr_tier\n  FROM tracked_keyword_data\n  GROUP BY query, page\n),\n\nweekly_trends AS (\n  SELECT \n    query,\n    page,\n    -- Calculate week-over-week change\n    LAG(SUM(clicks), 1) OVER (PARTITION BY query, page ORDER BY week) as prev_week_clicks,\n    SUM(clicks) as current_week_clicks,\n    SAFE_DIVIDE(\n      SUM(clicks) - LAG(SUM(clicks), 1) OVER (PARTITION BY query, page ORDER BY week),\n      LAG(SUM(clicks), 1) OVER (PARTITION BY query, page ORDER BY week)\n    ) * 100 as clicks_change_percent\n  FROM tracked_keyword_data\n  WHERE week >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY), WEEK)\n  GROUP BY query, page, week\n),\n\nlatest_trends AS (\n  SELECT \n    query,\n    page,\n    clicks_change_percent\n  FROM weekly_trends\n  WHERE current_week_clicks IS NOT NULL\n  AND week = DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY), WEEK)\n),\n\n-- üéØ PRIORITY SCORE CALCULATION\nkeyword_priority_scores AS (\n  SELECT \n    kp.*,\n    COALESCE(lt.clicks_change_percent, 0) as trend_percent,\n    \n    -- üìä CALCULATE PRIORITY SCORE (0-100)\n    ROUND(\n      -- Impressions component (30%)\n      (CASE \n        WHEN kp.volume_tier = 'HIGH_VOLUME' THEN 30\n        WHEN kp.volume_tier = 'MEDIUM_VOLUME' THEN 20\n        ELSE 10\n      END) +\n      \n      -- Position component (25%) - lower position = higher score\n      (CASE \n        WHEN kp.position_tier = 'TOP_3' THEN 25\n        WHEN kp.position_tier = 'TOP_10' THEN 20\n        WHEN kp.position_tier = 'TOP_20' THEN 15\n        ELSE 5\n      END) +\n      \n      -- CTR component (20%)\n      (CASE \n        WHEN kp.ctr_tier = 'GOOD_CTR' THEN 20\n        WHEN kp.ctr_tier = 'AVERAGE_CTR' THEN 15\n        ELSE 5  -- LOW_CTR gets low score but is optimization opportunity\n      END) +\n      \n      -- Clicks component (15%)\n      (CASE \n        WHEN kp.total_clicks >= 100 THEN 15\n        WHEN kp.total_clicks >= 20 THEN 10\n        WHEN kp.total_clicks >= 5 THEN 5\n        ELSE 2\n      END) +\n      \n      -- Trend component (10%)\n      (CASE \n        WHEN COALESCE(lt.clicks_change_percent, 0) > 20 THEN 10\n        WHEN COALESCE(lt.clicks_change_percent, 0) > 0 THEN 7\n        WHEN COALESCE(lt.clicks_change_percent, 0) > -20 THEN 5\n        ELSE 2\n      END)\n    ) as priority_score,\n    \n    -- üéØ OPTIMIZATION OPPORTUNITY CLASSIFICATION\n    CASE \n      WHEN kp.avg_position BETWEEN 4 AND 10 AND kp.total_impressions > 1000 THEN 'POSITION_OPPORTUNITY'\n      WHEN kp.avg_ctr < {{ $json.priority_config.priority_scoring.low_ctr_threshold }} AND kp.total_impressions > 500 THEN 'CTR_OPPORTUNITY'\n      WHEN kp.avg_position BETWEEN 11 AND 20 AND kp.total_impressions > 200 THEN 'VISIBILITY_OPPORTUNITY'\n      WHEN COALESCE(lt.clicks_change_percent, 0) < -30 THEN 'DECLINING_KEYWORD'\n      WHEN kp.total_impressions > {{ $json.priority_config.priority_scoring.high_impressions_threshold }} THEN 'HIGH_VALUE_MONITOR'\n      ELSE 'STANDARD_TRACKING'\n    END as opportunity_type\n    \n  FROM keyword_performance kp\n  LEFT JOIN latest_trends lt ON kp.query = lt.query AND kp.page = lt.page\n)\n\n-- üéØ FINAL RESULTS: Prioritized keywords\nSELECT \n  query,\n  page,\n  total_clicks,\n  total_impressions,\n  avg_ctr,\n  avg_position,\n  days_with_data,\n  volume_tier,\n  position_tier,\n  ctr_tier,\n  trend_percent,\n  priority_score,\n  opportunity_type,\n  \n  -- üèÜ FINAL PRIORITY CLASSIFICATION\n  CASE \n    WHEN priority_score >= 80 THEN 'CRITICAL'\n    WHEN priority_score >= 60 THEN 'HIGH'\n    WHEN priority_score >= 40 THEN 'MEDIUM'\n    ELSE 'LOW'\n  END as final_priority\n  \nFROM keyword_priority_scores\nORDER BY priority_score DESC, total_impressions DESC\nLIMIT {{ $json.priority_config.keywords_batch_size }}"
      },
      "id": "keyword_priority_analysis",
      "name": "Keyword Priority Analysis",
      "type": "n8n-nodes-base.googleBigQuery",
      "typeVersion": 1,
      "position": [1120, 300],
      "notes": "üéØ KEYWORD PRIORITY ANALYSIS\n\nüìä PRIORITY SCORING (0-100):\n‚Ä¢ Impressions (30%): Search volume impact\n‚Ä¢ Position (25%): Current ranking strength\n‚Ä¢ CTR (20%): Click-through performance\n‚Ä¢ Clicks (15%): Actual traffic value\n‚Ä¢ Trend (10%): Performance momentum\n\nüèÜ PRIORITY LEVELS:\n‚Ä¢ CRITICAL (80-100): Immediate attention\n‚Ä¢ HIGH (60-79): High impact opportunities\n‚Ä¢ MEDIUM (40-59): Standard monitoring\n‚Ä¢ LOW (0-39): Low priority tracking\n\nüéØ OPPORTUNITY TYPES:\n‚Ä¢ POSITION_OPPORTUNITY: Rankings 4-10\n‚Ä¢ CTR_OPPORTUNITY: Low CTR, high impressions\n‚Ä¢ VISIBILITY_OPPORTUNITY: Rankings 11-20\n‚Ä¢ DECLINING_KEYWORD: 30%+ traffic drop\n‚Ä¢ HIGH_VALUE_MONITOR: High volume tracking\n‚Ä¢ STANDARD_TRACKING: Regular monitoring\n\nüìà FEATURES:\n‚Ä¢ Weekly trend analysis\n‚Ä¢ Volume tier classification\n‚Ä¢ Performance benchmarking\n‚Ä¢ Optimization opportunity identification"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "projectId": "={{ $env.GCP_PROJECT_ID }}",
        "query": "-- üìä PERFORMANCE DATA WITH KEYWORD CONTEXT\n-- Enhanced performance query considering tracked keywords\n\nWITH recent_data AS (\n  SELECT \n    date,\n    page,\n    query,\n    clicks,\n    impressions,\n    SAFE_DIVIDE(clicks, impressions) * 100 as ctr,\n    position,\n    device,\n    -- üéØ Mark if this is a tracked keyword\n    CASE \n      WHEN {{ $(\"Process Keywords\").first().json.processing_status.has_tracked_keywords || false }} = true \n           {{ $(\"Process Keywords\").first().json.keywords_query_filter || '' }}\n      THEN true\n      ELSE false\n    END as is_tracked_keyword\n  FROM `{{ $env.GCP_PROJECT_ID }}.searchconsole.searchdata_site_impression`\n  WHERE \n    date >= '{{ $json.date_range.start_date }}'\n    AND date <= '{{ $json.date_range.end_date }}'\n    AND impressions >= {{ $json.priority_config.priority_scoring.min_clicks_threshold }}\n),\n\npage_performance AS (\n  SELECT \n    page,\n    SUM(clicks) as total_clicks,\n    SUM(impressions) as total_impressions,\n    SAFE_DIVIDE(SUM(clicks), SUM(impressions)) * 100 as avg_ctr,\n    AVG(position) as avg_position,\n    COUNT(DISTINCT query) as keyword_count,\n    COUNT(DISTINCT CASE WHEN is_tracked_keyword THEN query END) as tracked_keyword_count,\n    DATE_DIFF(CURRENT_DATE(), MAX(date), DAY) as days_since_last_data\n  FROM recent_data\n  GROUP BY page\n),\n\ntraffic_trends AS (\n  SELECT \n    page,\n    DATE_TRUNC(date, WEEK) as week,\n    SUM(clicks) as weekly_clicks,\n    SUM(impressions) as weekly_impressions\n  FROM recent_data\n  GROUP BY page, week\n),\n\nweekly_comparison AS (\n  SELECT \n    page,\n    LAG(weekly_clicks, 1) OVER (PARTITION BY page ORDER BY week) as prev_week_clicks,\n    weekly_clicks as current_week_clicks,\n    SAFE_DIVIDE(weekly_clicks - LAG(weekly_clicks, 1) OVER (PARTITION BY page ORDER BY week), LAG(weekly_clicks, 1) OVER (PARTITION BY page ORDER BY week)) * 100 as click_change_percent\n  FROM traffic_trends\n  WHERE week = DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY), WEEK)\n)\n\nSELECT \n  pp.page,\n  pp.total_clicks,\n  pp.total_impressions,\n  pp.avg_ctr,\n  pp.avg_position,\n  pp.keyword_count,\n  pp.tracked_keyword_count,\n  pp.days_since_last_data,\n  COALESCE(wc.click_change_percent, 0) as click_change_percent,\n  \n  -- üéØ Enhanced alert classification considering tracked keywords\n  CASE \n    WHEN COALESCE(wc.click_change_percent, 0) < -20 AND pp.tracked_keyword_count > 0 THEN 'tracked_keyword_drop'\n    WHEN COALESCE(wc.click_change_percent, 0) < -20 THEN 'traffic_drop'\n    WHEN COALESCE(wc.click_change_percent, 0) > 20 AND pp.tracked_keyword_count > 0 THEN 'tracked_keyword_surge'\n    WHEN COALESCE(wc.click_change_percent, 0) > 20 THEN 'traffic_surge'\n    WHEN pp.avg_ctr < {{ $json.priority_config.priority_scoring.low_ctr_threshold }} AND pp.total_impressions > 1000 AND pp.tracked_keyword_count > 0 THEN 'tracked_low_ctr'\n    WHEN pp.avg_ctr < {{ $json.priority_config.priority_scoring.low_ctr_threshold }} AND pp.total_impressions > 1000 THEN 'low_ctr'\n    WHEN pp.avg_position > {{ $json.priority_config.priority_scoring.medium_position_threshold }} AND pp.total_impressions > 500 AND pp.tracked_keyword_count > 0 THEN 'tracked_low_position'\n    WHEN pp.avg_position > {{ $json.priority_config.priority_scoring.medium_position_threshold }} AND pp.total_impressions > 500 THEN 'low_position'\n    WHEN pp.days_since_last_data > 7 THEN 'potential_deindex'\n    WHEN pp.tracked_keyword_count > 0 THEN 'tracked_normal'\n    ELSE 'normal'\n  END as alert_type,\n  \n  -- üéØ Page priority based on tracked keyword presence\n  CASE \n    WHEN pp.tracked_keyword_count > 0 AND pp.total_impressions > {{ $json.priority_config.priority_scoring.high_impressions_threshold }} THEN 'HIGH'\n    WHEN pp.tracked_keyword_count > 0 AND pp.total_impressions > {{ $json.priority_config.priority_scoring.medium_impressions_threshold }} THEN 'MEDIUM'\n    WHEN pp.tracked_keyword_count > 0 THEN 'LOW'\n    ELSE 'UNTRACKED'\n  END as page_priority\n  \nFROM page_performance pp\nLEFT JOIN weekly_comparison wc ON pp.page = wc.page\nORDER BY \n  CASE WHEN pp.tracked_keyword_count > 0 THEN 0 ELSE 1 END,  -- Tracked keywords first\n  pp.total_clicks DESC\nLIMIT {{ $json.priority_config.performance_batch_size }}"
      },
      "id": "enhanced_performance_data",
      "name": "Enhanced Performance Data",
      "type": "n8n-nodes-base.googleBigQuery",
      "typeVersion": 1,
      "position": [1120, 500],
      "notes": "üìä ENHANCED PERFORMANCE DATA\n\nüéØ KEYWORD-AWARE ANALYSIS:\n‚Ä¢ Identifies tracked keyword pages\n‚Ä¢ Prioritizes tracked keyword performance\n‚Ä¢ Enhanced alert classification\n‚Ä¢ Page priority scoring\n\nüö® ENHANCED ALERTS:\n‚Ä¢ tracked_keyword_drop: Tracked keywords losing traffic\n‚Ä¢ tracked_keyword_surge: Tracked keywords gaining traffic\n‚Ä¢ tracked_low_ctr: Tracked keywords with low CTR\n‚Ä¢ tracked_low_position: Tracked keywords ranking poorly\n‚Ä¢ tracked_normal: Tracked keywords performing normally\n\nüìà PAGE PRIORITIES:\n‚Ä¢ HIGH: Tracked keywords + high impressions\n‚Ä¢ MEDIUM: Tracked keywords + medium impressions\n‚Ä¢ LOW: Tracked keywords + low impressions\n‚Ä¢ UNTRACKED: No tracked keywords\n\nüîß FEATURES:\n‚Ä¢ Tracked keyword counting\n‚Ä¢ Priority-based sorting\n‚Ä¢ Enhanced classification\n‚Ä¢ Performance context"
    },
    {
      "parameters": {
        "jsCode": "// üéØ COMPREHENSIVE DATA PROCESSOR\n// Combines keyword priority analysis with performance data\n\ntry {\n  // üìä Extract all data sources\n  const keywordData = $input.all().find(item => item.json.query)?.json || {};\n  const performanceData = $input.all().find(item => item.json.page)?.json || {};\n  const trackedKeywords = $(\"Process Keywords\").first()?.json?.tracked_keywords || [];\n  const priorityConfig = $json.priority_config || {};\n  \n  // üõ°Ô∏è Data validation\n  const validKeywordData = Array.isArray(keywordData) ? keywordData : (keywordData.query ? [keywordData] : []);\n  const validPerformanceData = Array.isArray(performanceData) ? performanceData : (performanceData.page ? [performanceData] : []);\n  \n  // üéØ Process keyword priorities\n  const keywordPriorities = validKeywordData.map(keyword => {\n    // Find matching tracked keyword\n    const trackedKeyword = trackedKeywords.find(tk => \n      tk.keyword === keyword.query?.toLowerCase()\n    );\n    \n    return {\n      ...keyword,\n      is_tracked: !!trackedKeyword,\n      manual_priority: trackedKeyword?.priority || null,\n      business_value: trackedKeyword?.business_value || null,\n      target_position: trackedKeyword?.target_position || null,\n      notes: trackedKeyword?.notes || null\n    };\n  });\n  \n  // üìä Comprehensive analysis data\n  const comprehensiveData = {\n    // üéØ KEYWORD ANALYSIS\n    keyword_priorities: keywordPriorities,\n    keyword_summary: {\n      total_analyzed: keywordPriorities.length,\n      tracked_keywords: keywordPriorities.filter(k => k.is_tracked).length,\n      critical_priority: keywordPriorities.filter(k => k.final_priority === 'CRITICAL').length,\n      high_priority: keywordPriorities.filter(k => k.final_priority === 'HIGH').length,\n      medium_priority: keywordPriorities.filter(k => k.final_priority === 'MEDIUM').length,\n      low_priority: keywordPriorities.filter(k => k.final_priority === 'LOW').length\n    },\n    \n    // üìä PERFORMANCE ANALYSIS\n    performance_data: validPerformanceData,\n    performance_summary: {\n      total_pages: validPerformanceData.length,\n      tracked_pages: validPerformanceData.filter(p => (p.tracked_keyword_count || 0) > 0).length,\n      high_priority_pages: validPerformanceData.filter(p => p.page_priority === 'HIGH').length,\n      total_clicks: validPerformanceData.reduce((sum, p) => sum + (parseInt(p.total_clicks) || 0), 0),\n      total_impressions: validPerformanceData.reduce((sum, p) => sum + (parseInt(p.total_impressions) || 0), 0)\n    },\n    \n    // üéØ PRIORITY OPPORTUNITIES\n    opportunities: {\n      position_opportunities: keywordPriorities.filter(k => k.opportunity_type === 'POSITION_OPPORTUNITY'),\n      ctr_opportunities: keywordPriorities.filter(k => k.opportunity_type === 'CTR_OPPORTUNITY'),\n      visibility_opportunities: keywordPriorities.filter(k => k.opportunity_type === 'VISIBILITY_OPPORTUNITY'),\n      declining_keywords: keywordPriorities.filter(k => k.opportunity_type === 'DECLINING_KEYWORD'),\n      high_value_monitors: keywordPriorities.filter(k => k.opportunity_type === 'HIGH_VALUE_MONITOR')\n    },\n    \n    // üìÖ METADATA\n    analysis_date: new Date().toISOString().split('T')[0],\n    processing_time: new Date().toISOString(),\n    \n    // üîß PROCESSING STATUS\n    processing_status: {\n      success: true,\n      keyword_analysis_complete: true,\n      performance_analysis_complete: true,\n      total_records: keywordPriorities.length + validPerformanceData.length,\n      has_tracked_keywords: trackedKeywords.length > 0\n    }\n  };\n  \n  console.log(`‚úÖ Comprehensive Analysis Complete:`);\n  console.log(`üéØ Keywords Analyzed: ${keywordPriorities.length}`);\n  console.log(`üìä Pages Analyzed: ${validPerformanceData.length}`);\n  console.log(`üèÜ Critical Keywords: ${comprehensiveData.keyword_summary.critical_priority}`);\n  console.log(`üìà High Priority Keywords: ${comprehensiveData.keyword_summary.high_priority}`);\n  \n  return { json: comprehensiveData };\n  \n} catch (error) {\n  console.error('‚ùå Comprehensive Analysis Error:', error.message);\n  \n  return {\n    json: {\n      keyword_priorities: [],\n      keyword_summary: { total_analyzed: 0, tracked_keywords: 0, critical_priority: 0, high_priority: 0, medium_priority: 0, low_priority: 0 },\n      performance_data: [],\n      performance_summary: { total_pages: 0, tracked_pages: 0, high_priority_pages: 0, total_clicks: 0, total_impressions: 0 },\n      opportunities: { position_opportunities: [], ctr_opportunities: [], visibility_opportunities: [], declining_keywords: [], high_value_monitors: [] },\n      analysis_date: new Date().toISOString().split('T')[0],\n      processing_time: new Date().toISOString(),\n      processing_status: {\n        success: false,\n        keyword_analysis_complete: false,\n        performance_analysis_complete: false,\n        total_records: 0,\n        has_tracked_keywords: false,\n        error: error.message\n      }\n    }\n  };\n}"
      },
      "id": "comprehensive_processor",
      "name": "Comprehensive Data Processor",
      "type": "n8n-nodes-base.code",\n      "typeVersion": 2,
      "position": [1340, 350],
      "notes": "üéØ COMPREHENSIVE DATA PROCESSOR\n\nüìä PROCESSING FEATURES:\n‚Ä¢ Combines keyword priorities with performance\n‚Ä¢ Matches tracked keywords with manual priorities\n‚Ä¢ Calculates comprehensive summaries\n‚Ä¢ Identifies optimization opportunities\n\nüèÜ PRIORITY ANALYSIS:\n‚Ä¢ Critical/High/Medium/Low classification\n‚Ä¢ Tracked vs untracked keyword analysis\n‚Ä¢ Business value integration\n‚Ä¢ Target position tracking\n\nüéØ OPPORTUNITY IDENTIFICATION:\n‚Ä¢ Position improvement opportunities\n‚Ä¢ CTR optimization targets\n‚Ä¢ Visibility enhancement chances\n‚Ä¢ Declining keyword alerts\n‚Ä¢ High-value monitoring candidates\n\nüõ°Ô∏è DATA INTEGRITY:\n‚Ä¢ Null-safe processing\n‚Ä¢ Array validation\n‚Ä¢ Error handling\n‚Ä¢ Status tracking"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.anthropic.com/v1/messages",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "headers": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "body": {
          "parameters": [
            {
              "name": "model",
              "value": "claude-3-5-sonnet-20241022"
            },
            {
              "name": "max_tokens",
              "value": 4000
            },
            {
              "name": "messages",
              "value": "=[{\n  \"role\": \"user\",\n  \"content\": `You are an expert SEO strategist specializing in keyword prioritization and performance optimization. Analyze this comprehensive SEO data with priority scoring and provide strategic insights.\n\nüéØ KEYWORD PRIORITY ANALYSIS SUMMARY:\n‚Ä¢ Total Keywords Analyzed: ${$json.keyword_summary.total_analyzed}\n‚Ä¢ Tracked Keywords: ${$json.keyword_summary.tracked_keywords}\n‚Ä¢ Critical Priority: ${$json.keyword_summary.critical_priority}\n‚Ä¢ High Priority: ${$json.keyword_summary.high_priority}\n‚Ä¢ Medium Priority: ${$json.keyword_summary.medium_priority}\n‚Ä¢ Low Priority: ${$json.keyword_summary.low_priority}\n\nüìä PERFORMANCE OVERVIEW:\n‚Ä¢ Total Pages: ${$json.performance_summary.total_pages}\n‚Ä¢ Tracked Keyword Pages: ${$json.performance_summary.tracked_pages}\n‚Ä¢ High Priority Pages: ${$json.performance_summary.high_priority_pages}\n‚Ä¢ Total Clicks: ${$json.performance_summary.total_clicks.toLocaleString()}\n‚Ä¢ Total Impressions: ${$json.performance_summary.total_impressions.toLocaleString()}\n\nüéØ OPTIMIZATION OPPORTUNITIES:\n‚Ä¢ Position Opportunities: ${$json.opportunities.position_opportunities.length}\n‚Ä¢ CTR Opportunities: ${$json.opportunities.ctr_opportunities.length}\n‚Ä¢ Visibility Opportunities: ${$json.opportunities.visibility_opportunities.length}\n‚Ä¢ Declining Keywords: ${$json.opportunities.declining_keywords.length}\n‚Ä¢ High Value Monitors: ${$json.opportunities.high_value_monitors.length}\n\nüèÜ TOP PRIORITY KEYWORDS (CRITICAL & HIGH):\n${JSON.stringify(\n  $json.keyword_priorities\n    .filter(k => k.final_priority === 'CRITICAL' || k.final_priority === 'HIGH')\n    .slice(0, 10), \n  null, 2\n)}\n\nüìà POSITION IMPROVEMENT OPPORTUNITIES:\n${JSON.stringify($json.opportunities.position_opportunities.slice(0, 5), null, 2)}\n\nüéØ CTR OPTIMIZATION TARGETS:\n${JSON.stringify($json.opportunities.ctr_opportunities.slice(0, 5), null, 2)}\n\n‚ö†Ô∏è DECLINING KEYWORDS:\n${JSON.stringify($json.opportunities.declining_keywords.slice(0, 3), null, 2)}\n\nüìä HIGH-PRIORITY PAGES PERFORMANCE:\n${JSON.stringify(\n  $json.performance_data\n    .filter(p => p.page_priority === 'HIGH')\n    .slice(0, 5), \n  null, 2\n)}\n\nProvide analysis in this EXACT format:\n\nüéØ **SEO KEYWORD PRIORITY REPORT - ${$json.analysis_date}**\n\n**üìä EXECUTIVE SUMMARY:**\n‚Ä¢ Keywords Analyzed: ${$json.keyword_summary.total_analyzed}\n‚Ä¢ Critical/High Priority: ${$json.keyword_summary.critical_priority + $json.keyword_summary.high_priority}\n‚Ä¢ Tracked Keywords: ${$json.keyword_summary.tracked_keywords}\n‚Ä¢ Key Focus: [Main strategic focus based on data]\n\n**üö® CRITICAL PRIORITY ACTIONS:**\n[List top 3-5 critical keywords/pages needing immediate attention]\n\n**üèÜ HIGH-IMPACT OPPORTUNITIES:**\n‚Ä¢ **Position Wins:** [Keywords ranking 4-10 that could reach top 3]\n‚Ä¢ **CTR Boosts:** [High-impression keywords with low CTR]\n‚Ä¢ **Quick Wins:** [Easiest optimization opportunities]\n\n**üìà KEYWORD PERFORMANCE ANALYSIS:**\n‚Ä¢ **Top Performers:** [Best performing tracked keywords]\n‚Ä¢ **Underperformers:** [Tracked keywords not meeting expectations]\n‚Ä¢ **Trending:** [Keywords with significant changes]\n\n**‚ö†Ô∏è ATTENTION REQUIRED:**\n‚Ä¢ **Declining Keywords:** [Keywords losing traffic/position]\n‚Ä¢ **Missed Opportunities:** [High potential, low performance]\n‚Ä¢ **Technical Issues:** [Keywords with indexing/crawl problems]\n\n**üéØ STRATEGIC RECOMMENDATIONS:**\n1. **Immediate Actions (Next 7 Days):**\n   ‚Ä¢ [Specific action for critical keywords]\n   ‚Ä¢ [Specific action for high-priority opportunities]\n   \n2. **Medium-term Focus (Next 30 Days):**\n   ‚Ä¢ [Strategic optimization initiatives]\n   ‚Ä¢ [Content development priorities]\n   \n3. **Long-term Strategy (Next Quarter):**\n   ‚Ä¢ [Comprehensive optimization plans]\n   ‚Ä¢ [New keyword targeting strategies]\n\n**üìä PRIORITY MATRIX:**\n‚Ä¢ **Critical + High Volume:** [Keywords needing urgent attention]\n‚Ä¢ **High Position + Low CTR:** [Title/meta optimization targets]\n‚Ä¢ **Medium Position + High Volume:** [Content optimization priorities]\n‚Ä¢ **Low Position + High Potential:** [Link building targets]\n\n**üîÑ TRACKING ADJUSTMENTS:**\n‚Ä¢ **Add to Tracking:** [New keywords to monitor]\n‚Ä¢ **Increase Priority:** [Keywords to upgrade priority]\n‚Ä¢ **Review Performance:** [Keywords for priority reassessment]\n\n**üìà EXPECTED IMPACT:**\n‚Ä¢ **Traffic Potential:** [Estimated traffic increase from optimizations]\n‚Ä¢ **Position Improvements:** [Expected ranking gains]\n‚Ä¢ **Timeline:** [Expected timeframe for results]\n\nFocus on actionable, prioritized recommendations with clear expected outcomes and timelines.`\n}]"
            }
          ]
        }
      },
      "id": "claude_priority_analysis",
      "name": "Claude AI - Priority Analysis",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [1560, 350],
      "notes": "ü§ñ CLAUDE AI PRIORITY ANALYSIS\n\nüéØ SPECIALIZED ANALYSIS:\n‚Ä¢ Keyword prioritization expertise\n‚Ä¢ Strategic optimization planning\n‚Ä¢ Priority matrix development\n‚Ä¢ Impact estimation\n\nüèÜ ANALYSIS FEATURES:\n‚Ä¢ Critical/high priority focus\n‚Ä¢ Opportunity identification\n‚Ä¢ Strategic recommendations\n‚Ä¢ Timeline planning\n\nüìä COMPREHENSIVE INSIGHTS:\n‚Ä¢ Executive summary\n‚Ä¢ Critical actions\n‚Ä¢ High-impact opportunities\n‚Ä¢ Performance analysis\n‚Ä¢ Attention alerts\n‚Ä¢ Strategic roadmap\n‚Ä¢ Tracking adjustments\n‚Ä¢ Impact projections\n\nüîß OPTIMIZATION:\n‚Ä¢ Priority-based recommendations\n‚Ä¢ Actionable insights\n‚Ä¢ Clear timelines\n‚Ä¢ Expected outcomes"
    },
    {
      "parameters": {
        "jsCode": "// üì± PRIORITY REPORT FORMATTING\n// Enhanced formatting for keyword priority reports\n\nconst response = $json.content[0].text;\n\n// üéØ Enhanced formatting with priority context\nconst formatForTelegram = {\n  report: response,\n  timestamp: new Date().toISOString(),\n  date_readable: new Date().toLocaleDateString('en-US', {\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  }),\n  chat_id: $env.TELEGRAM_CHAT_ID,\n  parse_mode: 'Markdown',\n  disable_web_page_preview: true,\n  disable_notification: false,\n  \n  // üéØ PRIORITY-SPECIFIC METADATA\n  priority_metadata: {\n    report_type: 'KEYWORD_PRIORITY',\n    processing_mode: 'PRIORITY_ANALYSIS',\n    character_count: response.length,\n    word_count: response.split(' ').length,\n    priority_focus: true,\n    keyword_analysis: true\n  }\n};\n\nreturn { json: formatForTelegram };"
      },
      "id": "format_priority_report",
      "name": "Format Priority Report",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1780, 350],
      "notes": "üì± PRIORITY REPORT FORMATTING\n\nüéØ PRIORITY-SPECIFIC FEATURES:\n‚Ä¢ Keyword priority context\n‚Ä¢ Strategic focus indicators\n‚Ä¢ Priority analysis metadata\n‚Ä¢ Enhanced tracking\n\nüìä FORMATTING:\n‚Ä¢ Markdown optimization\n‚Ä¢ Mobile-friendly layout\n‚Ä¢ Priority highlighting\n‚Ä¢ Strategic structure\n\nüîß METADATA:\n‚Ä¢ Report type identification\n‚Ä¢ Processing mode tracking\n‚Ä¢ Content analysis\n‚Ä¢ Focus area indicators"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $env.TELEGRAM_BOT_TOKEN }}/sendMessage",
        "headers": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "body": {
          "parameters": [
            {
              "name": "chat_id",
              "value": "={{ $json.chat_id }}"
            },
            {
              "name": "text",
              "value": "={{ $json.report }}"
            },
            {
              "name": "parse_mode",
              "value": "={{ $json.parse_mode }}"
            },
            {
              "name": "disable_web_page_preview",
              "value": "={{ $json.disable_web_page_preview }}"
            },
            {
              "name": "disable_notification",
              "value": "={{ $json.disable_notification }}"
            }
          ]
        }
      },
      "id": "send_priority_report",
      "name": "Send Priority Report",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [2000, 350],
      "notes": "üì± PRIORITY REPORT DELIVERY\n\nüéØ STRATEGIC DELIVERY:\n‚Ä¢ Priority-focused reports\n‚Ä¢ Keyword analysis insights\n‚Ä¢ Strategic recommendations\n‚Ä¢ Action-oriented content\n\nüìä FEATURES:\n‚Ä¢ High-priority notifications\n‚Ä¢ Strategic formatting\n‚Ä¢ Mobile optimization\n‚Ä¢ Immediate delivery\n\nüîß RELIABILITY:\n‚Ä¢ Error handling\n‚Ä¢ Delivery confirmation\n‚Ä¢ Status tracking\n‚Ä¢ Priority routing"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "authentication": "serviceAccount",
        "documentId": "={{ $env.KEYWORD_RESULTS_SHEET_ID }}",
        "sheetName": "Priority Analysis",
        "range": "A:M",
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "query",
              "displayName": "Keyword",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "page",
              "displayName": "Page",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "total_clicks",
              "displayName": "Clicks",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "total_impressions",
              "displayName": "Impressions",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "avg_ctr",
              "displayName": "CTR",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "avg_position",
              "displayName": "Position",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "priority_score",
              "displayName": "Priority Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "final_priority",
              "displayName": "Priority",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false
            },
            {
              "id": "opportunity_type",
              "displayName": "Opportunity",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false
            },
            {
              "id": "trend_percent",
              "displayName": "Trend %",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": false
            },
            {
              "id": "is_tracked",
              "displayName": "Tracked",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "boolean",
              "canBeUsedToMatch": false
            },
            {
              "id": "manual_priority",
              "displayName": "Manual Priority",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": false
            }
          ]
        },
        "options": {}
      },
      "id": "save_priority_results",
      "name": "Save Priority Results",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [1780, 600],
      "notes": "üíæ SAVE PRIORITY RESULTS\n\nüìä SHEET STRUCTURE:\n‚Ä¢ Date: Analysis date\n‚Ä¢ Keyword: Search query\n‚Ä¢ Page: Landing page URL\n‚Ä¢ Clicks/Impressions: Performance metrics\n‚Ä¢ CTR/Position: Ranking data\n‚Ä¢ Priority Score: Calculated score (0-100)\n‚Ä¢ Priority: CRITICAL/HIGH/MEDIUM/LOW\n‚Ä¢ Opportunity: Optimization type\n‚Ä¢ Trend %: Performance change\n‚Ä¢ Tracked: Is manually tracked\n‚Ä¢ Manual Priority: User-defined priority\n\nüéØ PURPOSE:\n‚Ä¢ Historical tracking\n‚Ä¢ Priority trend analysis\n‚Ä¢ Performance monitoring\n‚Ä¢ Strategic planning\n\nüìà BENEFITS:\n‚Ä¢ Data persistence\n‚Ä¢ Trend analysis\n‚Ä¢ Reporting capabilities\n‚Ä¢ Strategic insights"
    },
    {
      "parameters": {
        "jsCode": "// üìä PRIORITY WORKFLOW RESULT LOGGER\n// Enhanced logging for keyword priority workflows\n\nconst success = $json.ok;\nconst messageId = $json.message_id;\nconst errorDescription = $json.description;\n\nconst timestamp = new Date().toISOString();\nconst readableTime = new Date().toLocaleString('en-US', {\n  timeZone: 'UTC',\n  weekday: 'long',\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric',\n  hour: '2-digit',\n  minute: '2-digit',\n  second: '2-digit'\n});\n\n// üéØ Enhanced priority workflow logs\nif (success) {\n  console.log(`‚úÖ KEYWORD PRIORITY REPORT DELIVERED`);\n  console.log(`üì± Telegram Message ID: ${messageId}`);\n  console.log(`‚è∞ Delivery Time: ${readableTime}`);\n  console.log(`üéØ Analysis Type: KEYWORD PRIORITY`);\n  console.log(`üèÜ Report Status: DELIVERED`);\n  console.log(`üìä Priority Analysis: COMPLETE`);\n} else {\n  console.log(`‚ùå KEYWORD PRIORITY REPORT FAILED`);\n  console.log(`‚ö†Ô∏è Error: ${errorDescription}`);\n  console.log(`‚è∞ Failed At: ${readableTime}`);\n  console.log(`üéØ Analysis Type: KEYWORD PRIORITY`);\n  console.log(`üèÜ Report Status: FAILED`);\n}\n\n// üîç Priority workflow summary\nconsole.log(`üìã Workflow: SEO Keyword Priority Analysis`);\nconsole.log(`üîÑ Process: Daily Priority Analysis Complete`);\nconsole.log(`üìà Next Analysis: Tomorrow at 9 AM`);\nconsole.log(`üéØ Focus: Keyword Prioritization & Optimization`);\n\nreturn {\n  json: {\n    success: success,\n    message_id: messageId,\n    error_description: errorDescription,\n    timestamp: timestamp,\n    readable_time: readableTime,\n    analysis_type: 'KEYWORD_PRIORITY',\n    workflow_status: success ? 'PRIORITY_COMPLETED' : 'PRIORITY_FAILED',\n    next_execution: 'Tomorrow at 9 AM',\n    priority_analysis: true,\n    summary: {\n      process: 'SEO Keyword Priority Analysis',\n      status: success ? 'SUCCESS' : 'FAILED',\n      delivery_method: 'Telegram',\n      completion_time: readableTime,\n      analysis_focus: 'Keyword Prioritization'\n    }\n  }\n};"
      },
      "id": "log_priority_result",
      "name": "Log Priority Result",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2220, 350],
      "notes": "üìä PRIORITY RESULT LOGGING\n\nüéØ PRIORITY-SPECIFIC LOGGING:\n‚Ä¢ Analysis type tracking\n‚Ä¢ Priority completion status\n‚Ä¢ Keyword focus indicators\n‚Ä¢ Strategic metrics\n\nüìã LOG FEATURES:\n‚Ä¢ Success/failure status\n‚Ä¢ Message ID tracking\n‚Ä¢ Error description\n‚Ä¢ Analysis type indicator\n‚Ä¢ Priority completion confirmation\n\nüîç MONITORING:\n‚Ä¢ Priority workflow health\n‚Ä¢ Delivery reliability\n‚Ä¢ Analysis tracking\n‚Ä¢ Strategic insights\n\nüìä WORKFLOW SUMMARY:\n‚Ä¢ Process completion\n‚Ä¢ Next execution schedule\n‚Ä¢ Priority optimization focus\n‚Ä¢ Strategic status"
    }
  ],
  "connections": {
    "Daily Schedule": {
      "main": [
        [
          {
            "node": "Priority Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Priority Configuration": {
      "main": [
        [
          {
            "node": "Get Tracked Keywords",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Tracked Keywords": {
      "main": [
        [
          {
            "node": "Process Keywords",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Keywords": {
      "main": [
        [
          {
            "node": "Keyword Priority Analysis",
            "type": "main",
            "index": 0
          },
          {
            "node": "Enhanced Performance Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Keyword Priority Analysis": {
      "main": [
        [
          {
            "node": "Comprehensive Data Processor",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Priority Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Enhanced Performance Data": {
      "main": [
        [
          {
            "node": "Comprehensive Data Processor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Comprehensive Data Processor": {
      "main": [
        [
          {
            "node": "Claude AI - Priority Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude AI - Priority Analysis": {
      "main": [
        [
          {
            "node": "Format Priority Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Priority Report": {
      "main": [
        [
          {
            "node": "Send Priority Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Priority Report": {
      "main": [
        [
          {
            "node": "Log Priority Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "timeouts": {
      "default": 45000,
      "max": 90000
    }
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-12-07T00:00:00.000Z",
      "updatedAt": "2024-12-07T00:00:00.000Z",
      "id": "keyword-priority",
      "name": "Keyword Priority"
    },
    {
      "createdAt": "2024-12-07T00:00:00.000Z",
      "updatedAt": "2024-12-07T00:00:00.000Z",
      "id": "strategic",
      "name": "Strategic"
    },
    {
      "createdAt": "2024-12-07T00:00:00.000Z",
      "updatedAt": "2024-12-07T00:00:00.000Z",
      "id": "optimization",
      "name": "Optimization"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-12-07T00:00:00.000Z",
  "versionId": "2.2-priority"
}